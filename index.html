<!DOCTYPE html>
<html>

<head>
    <title>Control Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<script>
    function select(id1, id2) {
        //document.getElementsByClassName("content").style.display = "none";
        //var icons = document.querySelectorAll("home","request","volunteer","info");
        //var buttons = document.querySelectorAll("btn1","btn2","btn3","btn4");
        
        //var i;
        //for (i = 0; i < contents.length; i++) {
        //    icons[i].src = "assets/img/" + icons[i] + "inactive.png";
        //    buttons[i].style.borderLeft = "2px solid rgb(17, 17, 17)";
        //    buttons[i].style.backgroundColor = "rgb(17, 17, 17)";
        //}
        // need complete revamp
        document.getElementById("homecontents").style.display = "none";
        document.getElementById("requestcontents").style.display = "none";
        document.getElementById("volunteercontents").style.display = "none";
        document.getElementById("infocontents").style.display = "none";
        document.getElementById('home').src = "assets/img/homeinactive.png";
        document.getElementById('request').src = "assets/img/requestinactive.png";
        document.getElementById('volunteer').src = "assets/img/volunteerinactive.png";
        document.getElementById('info').src = "assets/img/infoinactive.png";
        document.getElementById('btn1').style.borderLeft = "2px solid rgb(17, 17, 17)";
        document.getElementById('btn2').style.borderLeft = "2px solid rgb(17, 17, 17)";
        document.getElementById('btn3').style.borderLeft = "2px solid rgb(17, 17, 17)";
        document.getElementById('btn4').style.borderLeft = "2px solid rgb(17, 17, 17)";
        document.getElementById('btn1').style.backgroundColor = "rgb(17, 17, 17)";
        document.getElementById('btn2').style.backgroundColor = "rgb(17, 17, 17)";
        document.getElementById('btn3').style.backgroundColor = "rgb(17, 17, 17)";
        document.getElementById('btn4').style.backgroundColor = "rgb(17, 17, 17)";

        document.getElementById(id1 + "contents").style.display = "block";
        document.getElementById(id2).style.backgroundColor = "rgb(27, 27, 27)";
        document.getElementById(id2).style.borderLeft = "2px solid cyan";
        document.getElementById(id1).src = "assets/img/" + id1 + "active.png";
    }
    function time(id) {
        date = new Date;
        m = date.getMinutes();
        s = date.getSeconds();
        ampm = "AM";
        h = date.getHours();
        if (h > 12) {
            h = h - 12;
            ampm = "PM"
        }
        h = checkTime(h);
        m = checkTime(m);
        s = checkTime(s);
        function checkTime(i) {
            if (i < 10) { i = "0" + i };
            return i;
        }
        result = '' + h + ':' + m + ':' + s + " " + ampm;
        document.getElementById(id).innerHTML = result;
        setTimeout('time("' + id + '");', '1000');
        return true;
    }
    function todaydate(id) {
        today = new Date;
        days = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday');
        months = new Array('January', 'February', 'March', 'April', 'May', 'June', 'Jully', 'August', 'September', 'October', 'November', 'December');
        year = today.getFullYear();
        month = today.getMonth();
        d = today.getDate();
        day = today.getDay();
        result = '' + days[day] + ', ' + d + ' ' + months[month] + ' ' + year;
        document.getElementById(id).innerHTML = result;
        setTimeout('todaydate("' + id + '");', '1000');
        return true;
    }
    function requestData1(req,id) {
            var obj, dbParam, xmlhttp, myObj, x, txt = "";
            obj = { table: "customers", limit: 20 };
            dbParam = JSON.stringify(obj);
            xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    myObj = JSON.parse(this.responseText);
                    var table = "<tr><th>Name</th><th>Location</th></tr>";
                    txt += "<table border='1'>"
                    for (x in myObj) {
                        txt += "<tr><td>" + myObj[x].total + "</td></td>";
                    }
                    txt += "</table>"
                    document.getElementById(id).innerHTML = txt;
                }
            };

            xmlhttp.open("GET", "http://localhost:8000/panel/stats", true);
            //xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xmlhttp.send("x=" + dbParam);
        }
        function requestData2(req,id) {
            var obj, dbParam, xmlhttp, myObj, x, txt = "";
            obj = { table: "customers", limit: 20 };
            dbParam = JSON.stringify(obj);
            xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    myObj = JSON.parse(this.responseText);
                    var table = "<tr><th>Name</th><th>Location</th></tr>";
                    txt += "<table border='1'>"
                    for (x in myObj) {
                        txt += "<tr><td>" + myObj[x].processing + "</td></td>";
                    }
                    txt += "</table>"
                    document.getElementById(id).innerHTML = txt;
                }
            };

            xmlhttp.open("GET", "http://localhost:8000/panel/stats", true);
            //xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xmlhttp.send("x=" + dbParam);
        }
        function requestData3(req,id) {
            var obj, dbParam, xmlhttp, myObj, x, txt = "";
            obj = { table: "customers", limit: 20 };
            dbParam = JSON.stringify(obj);
            xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    myObj = JSON.parse(this.responseText);
                    var table = "<tr><th>Name</th><th>Location</th></tr>";
                    txt += "<table border='1'>"
                    for (x in myObj) {
                        txt += "<tr><td>" + myObj[x].completed + "</td></td>";
                    }
                    txt += "</table>"
                    document.getElementById(id).innerHTML = txt;
                }
            };

            xmlhttp.open("GET", "http://localhost:8000/panel/stats", true);
            //xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xmlhttp.send("x=" + dbParam);
        }
        function requestData4(req,id) {
            var obj, dbParam, xmlhttp, myObj, x, txt = "";
            obj = { table: "customers", limit: 20 };
            dbParam = JSON.stringify(obj);
            xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    myObj = JSON.parse(this.responseText);
                    var table;
                    txt += "<table border='1'>"
                    for (x in myObj) {
                        txt += "<tr><td>" + myObj[x].pending + "</td></tr>";
                    }
                    txt += "</table>"
                    document.getElementById(id).innerHTML = txt;
                }
            };

            xmlhttp.open("GET", "http://localhost:8000/panel/stats", true);
            //xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xmlhttp.send("x=" + dbParam);
        }
</script>

<body>
    <div class="header">
        <div class="header1">
            <div><img src="assets/img/icons8-calendar-1-40.png" width="30px"></div>
            <span id="date"></span>
            <script type="text/javascript">window.onload = todaydate('date');</script>
        </div>
        <div class="header2">
            <div><img src="assets/img/icons8-clock-40.png" width="30px"></div>
            <span id="time"></span>
            <script type="text/javascript">window.onload = time('time');</script>
        </div>
    </div>
    <div class="sidenav">
        <div class="sidemenu">MENU</div>
        <button class="active" onclick="select('home','btn1')" id="btn1">
            <img class="active" id="home" src="assets/img/homeactive.png" width="40%"><br>
            HOME
        </button>
        <button onclick="select('request','btn2')" id="btn2">
            <img id="request" src="assets/img/requestinactive.png" width="40%"><br>
            REQUESTS
        </button>
        <button onclick="select('volunteer','btn3')" id="btn3">
            <img id="volunteer" src="assets/img/volunteerinactive.png" width="40%"><br>
            VOLUNTEERS
        </button>
        <button onclick="select('info','btn4')" id="btn4">
            <img id="info" src="assets/img/infoinactive.png" width="40%"><br>
            INFORMATION CENTRE
        </button>
    </div>

    <div class="main">
        <div id="homecontents" class="content">
            <div class="col-25">
                <h4 style="color: #e74c3c" ;>Requests Recieved</h4>
                <p>
                    <span id="demo1" style="text-align:center"></span>
                    <script type="text/javascript">window.onload = requestData1('total','demo1');</script>
                    <img src="assets/img/homerequest.png" style="width:45px" ;>
                </p>
            </div>
            <div class="col-25">
                <h4 style="color: #e74c3c" ;>Requests Processing</h4>
                <p>
                    <span id="demo2"></span>
                    <script type="text/javascript">window.onload = requestData2('processing','demo2');</script>
                    <img src="assets/img/homerequest.png" style="width:45px" ;></p>
            </div>
            <div class="col-25">
                <h4 style="color: #e74c3c" ;>Requests Completed</h4>
                <p>
                    <span id="demo3"></span>
                    <script type="text/javascript">window.onload = requestData3('completed','demo3');</script>
                    <img src="assets/img/homerequest.png" style="width:45px" ;></p>
            </div>
            <div class="col-25">
                <h4 style="color: #e74c3c" ;>Requests Pending</h4>
                <p>
                    <span id="demo4"></span>
                    <script type="text/javascript">window.onload = requestData4('pending','demo4');</script>
                    <img src="assets/img/homerequest.png" style="width:45px" ;></p>
            </div>
        </div>
        <div id="requestcontents" style="display:none" class="content">
            <p  style="text-align:center;font-size:24pt">REQUESTS
                <div id="output">
                    <script>
                        fetch('http://localhost:8000/panel/stats')
                            .then((res) => res.json())
                            .then((data) => {
                                console.log(data);
                                document.getElementById('output').innerHTML = data;
                                let output = 'Request Details';
                                data.forEach(function(user) {
                                    output += `<div>
                                            <p>Requests: ${user.total}</p>
                                        </div>`;
                                });
                                document.getElementById('output').innerHTML = output;
                            })
                            .catch(function (error) {
                                console.log(JSON.stringify(error));
                            });
                    </script>
                </div>
            </p>
        </div>
        <div id="volunteercontents" style="display:none" class="content">
            <p style="text-align:center;font-size:24pt">VOLUNTEERS</p>
            <div class="volcontainer">
                <div class="vollist" id="demo">
                    <p>Registered volunteers</p>
                </div>
                <div class="activevol">
                    <p>Active volunteers</p>
                </div>
            </div>
        </div>
        <div id="infocontents" style="display:none" class="content">
            <p style="text-align:center;font-size:24pt">INFORMATION CENTRE</p>
            <div class="infowindow">
                <div class="infocontainer">
                    <p>Information Title</p>
                    <input type="text" placeholder="Enter the news title"></input><br><br>
                    <textarea placeholder="Enter the news content"></textarea>
                    <br>
                    <input type="radio" name="priority" />High
                    <input type="radio" name="priority" />Low
                    <br>
                    <input type="submit" />
                </div>
                <div class="previnfo">
                    <p>Previous Informations</p>
                </div>
            </div>
        </div>
    </div>

</body>

</html>
